function toggleNotification(n){n?$("#page-notification").removeClass("toast-hide"):$("#page-notification").addClass("toast-hide")}function setNotificationContent(n){$("#page-notification-body").text(n)}function displayNotification(n){setNotificationContent(n);toggleNotification(!0);setTimeout(()=>{toggleNotification(!1)},3e3)}function toggleSubmit(n){$(submit).prop("disabled",!n)}function setupValidation(n){submit=n;$(".invalid-input[validate-for]").each(function(){let n=$(this).attr("validate-for"),t=$(this).attr("input-display-name"),u=$(this).attr("input-required"),i=$(this).attr("input-min-len"),r=$(this).attr("input-max-len");validationResults.set(n,$(this).attr("default-value")=="true");validationFields.push(document.getElementById(n));document.getElementById(n).addEventListener("input",function(){let f=$("#"+n).text();f=f!=null?f.trim():f;let e=!1;i!=null&&(e|=validate(n,t+" field must exceed "+i+" characters",isMinLen(f,i)));r!=null&&(e|=validate(n,t+" field cannot exceed "+r+" characters",isMaxLen(f,r)));u!=null&&(e|=validate(n,t+" field is required",isEmpty(f)));validationResults.set(n,!e);e||clearError(n)},!1)})}function validate(n,t,i){let r=!1;return i&&!firstValidation&&($(".invalid-input[validate-for='"+n+"']").text(t),$("#"+n).addClass("invalid-form"),toggleSubmit(!1),r=!0),firstValidation=!1,r}function isEmpty(n){return n==null||n.length==0}function isMinLen(n,t){return n.length<t&&n.length!=0}function isMaxLen(n,t){return n.length>t}function clearError(n){$(".invalid-input[validate-for='"+n+"']").text("");$("#"+n).removeClass("invalid-form");validateSubmit()}function fireAllValidation(){for(let n=0;n<validationFields.length;n++){let t=validationFields[n];t.dispatchEvent(new Event("input"))}}function fireValidation(n){document.getElementById(n).dispatchEvent(new Event("input"))}function validateSubmit(){let n=!0;for(let[,t]of validationResults)n&=t;toggleSubmit(n)}function setupCharacterCount(){$(".charcount-input[count-for]").each(function(){let n=$(this).attr("count-for");countCharacter(n);charCountListeners.push(document.getElementById(n).addEventListener("input",function(){countCharacter(n)},!1))})}function countCharacter(n){let t=$("#"+n).text();t=t!=null?t.trim():t;let i=t.length;i==0?$(".charcount-input[count-for='"+n+"']").text(""):$(".charcount-input[count-for='"+n+"']").text(i+" characters")}function bindData(){$("#input-raw").val(tinymce.activeEditor.getContent({format:"text"}));$("#input-content").val(tinymce.activeEditor.getContent());$("#input-tldr").val($("#form-tldr").text());$("#input-title").val($("#form-title").text())}function previewFile(){var t=$("input[type=file]").get(0).files[0],n;t&&(n=new FileReader,n.onload=function(){$("#article-img-cover").removeClass("d-none");$("#article-img-cover").attr("src",n.result)},n.readAsDataURL(t))}function hideField(n){$(n).addClass("d-none")}let firstValidation=!0,validationResults=new Map,validationFields=[],submit;let charCountListeners=[];$(document).ready(function(){tinymce.init({selector:"#form-content",setup:function(n){n.on("init",function(){n.setContent($("#input-content").val());firstValidation=!1;let t=$("#input-id").val();t!=null&&t.length>0&&fireAllValidation();validateSubmit()});n.on("WordCountUpdate",function(){let n=tinymce.activeEditor.plugins.wordcount.body.getCharacterCount();n!=0?$('.charcount-input[count-for="input-raw"]').text(n+" characters"):$('.charcount-input[count-for="input-raw"]').text("")})},placeholder:"article content here",inline:!0,plugins:"codesample autoresize link paste lists image wordcount",menubar:!1,contextmenu:!1,toolbar:"undo redo | styleselect | bold italic underline | numlist bullist | strikethrough subscript superscript | codesample image link",link_assume_external_targets:!0,paste_as_text:!0,paste_data_images:!0,branding:!1});let n=$("#form-title").text();n!=null&&$("#form-title").text(n.trim());setupValidation("#btnSubmit");setupCharacterCount()});document.querySelector("#form-title").addEventListener("paste",function(n){n.preventDefault();document.execCommand("inserttext",!1,n.clipboardData.getData("text/plain").trim())});document.querySelector("#form-tldr").addEventListener("paste",function(n){n.preventDefault();document.execCommand("inserttext",!1,n.clipboardData.getData("text/plain").trim())});var $navbar=$("#site-header");jQuery(window).on("scroll",function(){var n=jQuery(window).scrollTop(),t=jQuery(".article-header").offset().top+jQuery(".article-header").outerHeight();t*6/9>n?$navbar.removeClass("hide-nav"):$navbar.addClass("hide-nav")});$("img").on("error",function(){$(this).addClass("d-none")});$("#btnSave").click(function(n){n.preventDefault();bindData();let t=$("#form")[0],i=new FormData(t);return $("#btnReturn").prop("disabled",!0),$("#btnSave").prop("disabled",!0),$("#btnSubmit").prop("disabled",!0),$("#btnSave").children(":first").removeClass("fa-save"),$("#btnSave").children(":first").addClass("loader"),$.ajax({type:"POST",enctype:"multipart/form-data",url:DRAFT_ADDR,data:i,processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(n){displayNotification("Drafted successfully");$("#btnReturn").prop("disabled",!1);$("#btnSave").prop("disabled",!1);$("#btnSave").children(":first").addClass("fa-save");$("#btnSave").children(":first").removeClass("loader");fireAllValidation();validateSubmit();$("#input-id").val(n);$("#form").attr("action",$("#update-action-template").attr("action"))},error:function(n,t,i){console.log("fail: "+n+", "+t+", "+i);displayNotification("Service not available right now, please try again later");$("#btnReturn").prop("disabled",!1);$("#btnSave").prop("disabled",!1);$("#btnSave").children(":first").addClass("fa-save");$("#btnSave").children(":first").removeClass("loader");fireAllValidation();validateSubmit()}}),!1});